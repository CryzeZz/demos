<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工程导出文件名解析</title>
    <link rel="stylesheet" type="text/css" href="/hisui/dist/css/hisui.min.css">
    <script type="text/javascript" src="/hisui/dist/js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="/hisui/dist/js/jquery.hisui.js"></script>
    <script type="text/javascript" src="/hisui/dist/js/locale/hisui-lang-zh_CN.js"></script>
    <style>
        html,body{
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body class="">
    <div style="width: 1300px;height: 100%;margin: 0 auto;" class="hisui-layout">
        <div data-options="region:'north',border:false,split:false" style="height:40px;padding:10px 10px 0;line-height:30px;overflow: hidden;">
            请将工程导出时，studio的[output]区域打印出来的导出提示信息复制到左侧的文本框，然后点击格式化
        </div>
        <div data-options="region:'west',border:false,split:false" style="width:650px;padding:10px 5px 10px 10px;overflow: hidden;">
            <textarea class="textbox" id="src" style="width: 100%;height: 100%;box-sizing: border-box;"></textarea>
        </div>
        <div data-options="region:'center',border:false,split:false" style="height:50px;padding:10px 10px 10px 5px;line-height:30px;overflow: hidden;">
            <textarea class="textbox" id="dest" style="width: 100%;height: 100%;box-sizing: border-box;"></textarea>
        </div>
        <div data-options="region:'south',border:false,split:false" style="height:40px;padding:0 10px 10px;line-height:30px;text-align: center;overflow: hidden;">
            <a href="javscript:void(0);" class="hisui-linkbutton" id="format">格式化</a>
        </div>
    </div>
    <script>
        Array.prototype.trimpush=function(value){
            return this.push(  $.trim(value) )
            
        }
        function parsePrjout(src){
            var webApp='/imedical/web';
            if (src.indexOf('/imedical83/web')>-1) webApp='/imedical83/web';
            if (src.indexOf('/dthealth/web')>-1) webApp='/dthealth/web';


            var arr=src.split('\n'),clsArr=[],jsArr=[],cspArr=[];
            for(var i=0,len=arr.length;i<len;i++){
                var item=arr[i];
                if (item.indexOf('正在导出类:')>-1) {
                    clsArr.trimpush( item.split('正在导出类:')[1] )
                }else if (item.indexOf('Exporting class:')>-1) {
                    clsArr.trimpush( item.split('Exporting class:')[1] )
                }else if (item.indexOf('正在导出CSP/CSR或文件:')>-1) {
                    if (item.indexOf(webApp+'/csp/')>-1) {
                        cspArr.trimpush( item.split(webApp+'/csp/')[1] )
                    }else if (item.indexOf(webApp+'/scripts/')){
                        jsArr.trimpush( item.split(webApp+'/scripts/')[1] )
                    }
                }else if (item.indexOf('Exporting CSP/CSR or file: ')>-1) {
                    if (item.indexOf(webApp+'/csp/')>-1) {
                        cspArr.trimpush( item.split(webApp+'/csp/')[1] )
                    }else if (item.indexOf(webApp+'/scripts/')){
                        jsArr.trimpush( item.split(webApp+'/scripts/')[1] )
                    }
                }
            }
            var dest='';
            dest=dest+'类文件：\n'+clsArr.join('\n');
            dest=dest+'\n----------------分割线---------------------\n'
            dest=dest+'js文件：\n'+jsArr.join('\n');
            dest=dest+'\n----------------分割线---------------------\n'
            dest=dest+'csp文件：\n'+cspArr.join('\n');



            return dest;
        }
        $(function(){
            $('#format').click(function(){
                var src=$('#src').val();
                var dest=parsePrjout(src);
                $('#dest').val(dest);




            })



        })


    </script>
</body>
</html>